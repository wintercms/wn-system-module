"use strict";(self.webpackChunk_wintercms_system=self.webpackChunk_wintercms_system||[]).push([[878],{4349:function(e,t,o){var i=o(4471);const n=["textContent"],r=["textContent"],s=(0,i._)("div",{class:"field-control"},null,-1);o(6886);const p={ref:"popover",class:"inspector-wrapper"},l={key:0,class:"inspector popover-layout"},a=(0,i._)("div",{class:"arrow","data-popper-arrow":""},null,-1);var c=o(4769),d=o(335),f=o(2815),u=o(641),h=o(3108);function m(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function b(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?m(Object(o),!0).forEach((function(t){g(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):m(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function g(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var y={props:{shown:{type:Boolean,default:!1},snowboard:{type:Object,required:!0},inspectedElement:{type:HTMLElement,required:!0},hideFn:{type:Function,required:!0},placement:{type:String,default:"auto",validate:e=>-1!==["auto","top","right","bottom","left"].indexOf(e)},fallbackPlacement:{type:String,default:"bottom",validate:e=>-1!==["top","right","bottom","left"].indexOf(e)},offsetX:{type:Number,default:0},offsetY:{type:Number,default:0}},data:()=>({top:0,left:0,inspectedElementStyle:{position:null,zIndex:null},popperInstance:null}),watch:{shown(e){e?(this.snowboard.overlay().show(),this.highlightInspectedElement(),this.$nextTick((()=>{this.createPopper()}))):(this.popperInstance.destroy(),this.snowboard.overlay().hide())}},unmounted(){this.snowboard.overlay().hide()},methods:{createPopper(){this.popperInstance=(0,c.fi)(this.inspectedElement,this.$refs.popover,{modifiers:[d.Z,f.Z,u.Z,b(b({},h.Z),{},{options:{offset:[this.offsetX,this.offsetY+10]}})]})},highlightInspectedElement(){this.inspectedElementStyle.position=this.inspectedElement.style.position,this.inspectedElementStyle.zIndex=this.inspectedElement.style.zIndex,this.inspectedElement.style.position="relative",this.inspectedElement.style.zIndex=1001}}},v=o(6062),w=o.n(v),x=o(9941),C={insert:"head",singleton:!1},E=(w()(x.Z,C),x.Z.locals,o(4407));const k=(0,E.Z)(y,[["render",function(e,t,o,n,r,s){return(0,i.wg)(),(0,i.iD)("div",p,[(0,i.Wm)(i.uT,{name:"popover-fade"},{default:(0,i.w5)((()=>[o.shown?((0,i.wg)(),(0,i.iD)("div",l,[a,(0,i._)("header",null,[(0,i.WI)(e.$slots,"title"),(0,i.WI)(e.$slots,"description"),(0,i._)("div",{class:"inspector-hide wn-icon-remove",onClick:t[0]||(t[0]=(0,i.iM)((function(){return o.hideFn&&o.hideFn(...arguments)}),["stop"]))})]),(0,i._)("main",null,[(0,i.WI)(e.$slots,"fields")])])):(0,i.kq)("",!0)])),_:3})],512)}]]);var I=k;const O={class:"field"};var F={};const P={key:0,class:"field-label"},S=["textContent"];var j={props:{label:{type:[String,Boolean],default:!1}}};var D={components:{Field:(0,E.Z)(F,[["render",function(e,t,o,n,r,s){return(0,i.wg)(),(0,i.iD)("div",O,[(0,i.WI)(e.$slots,"default")])}]]),FieldLabel:(0,E.Z)(j,[["render",function(e,t,o,n,r,s){return o.label?((0,i.wg)(),(0,i.iD)("div",P,[(0,i._)("span",{class:"label",textContent:(0,i.zw)(o.label)},null,8,S)])):(0,i.kq)("",!0)}]])},props:{snowboard:{type:Object,required:!0},inspectedElement:{type:HTMLElement,required:!0},form:{type:HTMLElement,default:null},hideFn:{type:Function,required:!0},config:{type:[String,Object],default:null},title:{type:String,required:!0},description:{type:String,default:null},layout:{type:String,default:"popover",validate:e=>-1!==["popover","sidebar"].indexOf(e)},placement:{type:String,default:"auto",validate:e=>-1!==["auto","top","right","bottom","left"].indexOf(e)},fallbackPlacement:{type:String,default:"bottom",validate:e=>-1!==["top","right","bottom","left"].indexOf(e)},offsetX:{type:Number,default:0},offsetY:{type:Number,default:0}},data:()=>({showInspector:!1,userConfig:{title:null,description:null,fields:null}}),computed:{inspectorTitle(){return this.userConfig.title?this.userConfig.title:this.title},inspectorDescription(){return this.userConfig.description?this.userConfig.description:this.description},inspectorFields(){return this.userConfig.fields},layoutProps(){return{shown:this.showInspector,snowboard:this.snowboard,inspectedElement:this.inspectedElement,hideFn:this.hideFn,placement:this.placement,fallbackPlacement:this.fallbackPlacement,offsetX:this.offsetX,offsetY:this.offsetY}},layoutComponent:()=>I},mounted(){this.getConfiguration()},methods:{getConfiguration(){if(this.config){const e="string"==typeof this.config?JSON.parse(this.config):this.config;e.title&&(this.userConfig.title=e.title),e.description&&(this.userConfig.description=e.description),this.userConfig.fields=this.processFieldsConfig(e.fields||e.properties||{})}this.getConfigurationFromBackend()},getConfigurationFromBackend(){this.snowboard.request(this.form,"onGetInspectorConfiguration",{success:e=>{e.configuration.title&&(this.userConfig.title=e.configuration.title),e.configuration.description&&(this.userConfig.description=e.configuration.description),e.configuration.fields?this.userConfig.fields=this.processFieldsConfig(e.configuration.fields):e.configuration.properties&&(this.userConfig.fields=this.processFieldsConfig(e.configuration.properties))},complete:()=>{this.showInspector=!0}})},processFieldsConfig(e){const t=Array.isArray(e)?this.reformatProperties(e):e;return Object.entries(t).forEach((e=>{const[,t]=e;void 0!==t.title&&(void 0===t.label&&(t.label=t.title),delete t.title),"set"===t.type&&(t.type="checkboxlist")})),console.log(t),t},reformatProperties(e){const t={};return e.forEach((e=>{t[e.property]=e,delete t[e.property].property})),t}}};var z=(0,E.Z)(D,[["render",function(e,t,o,p,l,a){const c=(0,i.up)("FieldLabel"),d=(0,i.up)("Field");return(0,i.wg)(),(0,i.j4)((0,i.LL)(a.layoutComponent),(0,i.vs)((0,i.F4)(a.layoutProps)),{title:(0,i.w5)((()=>[a.inspectorTitle?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"inspector-title",textContent:(0,i.zw)(a.inspectorTitle)},null,8,n)):(0,i.kq)("",!0)])),description:(0,i.w5)((()=>[a.inspectorDescription?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"inspector-description",textContent:(0,i.zw)(a.inspectorDescription)},null,8,r)):(0,i.kq)("",!0)])),fields:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.inspectorFields,((e,t)=>((0,i.wg)(),(0,i.j4)(d,{key:t},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{label:e.label},null,8,["label"]),s])),_:2},1024)))),128))])),_:1},16)}]]);class q extends Snowboard.Singleton{constructor(e){super(e),this.inspectableElements=[],this.currentInspector=null}dependencies(){return["system.ui.overlay"]}listens(){return{ready:"ready","overlay.clicked":"hideInspector"}}ready(){this.bindInspectableElements()}destructor(){this.unbindInspectableElements(),this.inspectableElements=[],super.destructor()}bindInspectableElements(){window.document.querySelectorAll("[data-inspectable]").forEach((e=>{const t={element:e,form:this.findForm(e),inspectorElement:null,inspectorVue:null,container:this.findInspectableContainer(e),handler:e=>this.inspectableClick.call(this,e,t),title:e.dataset.inspectorTitle||"Inspector",description:e.dataset.inspectorDescription||null,config:e.dataset.inspectorConfig||null,offset:{x:e.dataset.inspectorOffsetX||e.dataset.inspectorOffset||0,y:e.dataset.inspectorOffsetY||e.dataset.inspectorOffset||0},placement:e.dataset.inspectorPlacement||null,fallbackPlacement:e.dataset.inspectorFallbackPlacement||"bottom",cssClasses:e.dataset.inspectorCssClass||null};this.inspectableElements.push(t),e.addEventListener("click",t.handler)}))}unbindInspectableElements(){}createInspector(e){e.inspectorElement=document.createElement("div"),document.body.appendChild(e.inspectorElement),this.currentInspector=e,e.inspectorVue=(0,i.ri)(z,{snowboard:this.snowboard,inspectedElement:e.element,form:e.form,title:e.title,description:e.description,placement:e.placement,fallbackPlacement:e.fallbackPlacement,offsetX:e.offset.x,offsetY:e.offset.y,hideFn:()=>this.hideInspector(),config:e.config}),e.inspectorVue.mount(e.inspectorElement)}hideInspector(){this.currentInspector&&(this.currentInspector.inspectorVue.unmount(),document.body.removeChild(this.currentInspector.inspectorElement),this.currentInspector=null)}inspectableClick(e,t){e.preventDefault(),t!==this.currentInspector&&this.createInspector(t)}findInspectableContainer(e){let t=e;for(;t.parentElement&&"HTML"!==t.parentElement.tagName;){if(t.matches("[data-inspector-container]"))return t;t=t.parentElement}return null}findForm(e){return e.closest("form")}}if(void 0===window.Snowboard)throw new Error("The Snowboard library must be loaded in order to use the Inspector widget");window.Snowboard.addPlugin("system.widgets.inspector",q)},9941:function(e,t,o){var i=o(2609),n=o.n(i)()((function(e){return e[1]}));n.push([e.id,'.inspector-wrapper{z-index:1002}.inspector.popover-layout{border-radius:3px;box-shadow:0 1px 6px rgba(0,0,0,.12),0 1px 4px rgba(0,0,0,.24);font-size:12px;position:relative;width:360px}.inspector.popover-layout .arrow,.inspector.popover-layout .arrow:before{height:10px;position:absolute;width:10px}.inspector.popover-layout .arrow{visibility:hidden;z-index:1002}.inspector.popover-layout .arrow:before{background-color:#3498db;content:"";transform:rotate(45deg);visibility:visible}.inspector.popover-layout header{background:#3498db;border-bottom:1px solid #2383c4;border-top-left-radius:3px;border-top-right-radius:3px;color:#fff;padding:10px 46px 10px 16px;position:relative;text-shadow:0 1px 1px rgba(0,0,0,.22);z-index:1003}.inspector.popover-layout header .inspector-title{font-size:14px;font-weight:700}.inspector.popover-layout header .inspector-description{font-size:12px;font-weight:400;margin-top:-3px}.inspector.popover-layout header .inspector-hide{background:#2383c4;border-bottom-left-radius:3px;border-top-right-radius:3px;cursor:pointer;height:30px;line-height:30px;position:absolute;right:0;text-align:center;top:0;transition:background-color 175ms ease;width:30px}.inspector.popover-layout header .inspector-hide:before{margin-right:0;opacity:.7;transition:opacity 175ms ease}.inspector.popover-layout header .inspector-hide:hover{background:#2077b2}.inspector.popover-layout header .inspector-hide:hover:before{opacity:1}.inspector.popover-layout main{background:#f2f2f2;border-bottom-left-radius:3px;border-bottom-right-radius:3px;position:relative;z-index:1003}.inspector.popover-layout main .field{display:flex;flex-direction:row;justify-content:stretch}.inspector.popover-layout main .field .field-label{background:#f2f2f2;border-right:1px solid #ccc;color:#405261;flex:3 0;padding:5px 10px}.inspector.popover-layout main .field .field-control{background:#fff;flex:5 0}.inspector.popover-layout main .field+.field{border-top:1px solid #ccc}.inspector-wrapper[data-popper-placement^=top] .inspector.popover-layout .arrow{bottom:-5px}.inspector-wrapper[data-popper-placement^=bottom] .inspector.popover-layout .arrow{top:-5px}.inspector-wrapper[data-popper-placement^=left] .inspector.popover-layout .arrow{right:-5px}.inspector-wrapper[data-popper-placement^=right] .inspector.popover-layout .arrow{left:-5px}.popover-fade-enter-active,.popover-fade-leave-active{transition:opacity 175ms ease-out,transform 175ms ease-out}.popover-fade-enter-from,.popover-fade-leave-to{opacity:0;transform:translateY(20px)}',""]),t.Z=n}},function(e){e.O(0,[96],(function(){return t=4349,e(e.s=t);var t}));e.O()}]);